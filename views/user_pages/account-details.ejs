<!DOCTYPE html>
<html lang="en">

<head>
	<title>
		<%= title %>
	</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="images/icons/favicon.png" />
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
	<link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<style>
		/* Overlay style */
.order-dialog-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Dialog style */
.order-dialog {
    display: none;
	max-width: 650px;
	min-width: 500px;

}

.order-dialog .modal-wrapper {
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
    width: 95%; /* Adjusted width */
    max-width: 800px; /* Maximum width */
    overflow-y: auto;
    padding: 20px;
}

/* Modal header */
.order-dialog .modal-header {
    border-bottom: 1px solid #ccc;
    margin-bottom: 20px;
}

.order-dialog .modal-header h2 {
    margin: 0;
    font-size: 24px;
    color: #333;
}

.order-dialog .close-details {
    color: #999;
    font-size: 24px;
    border: none;
    background: none;
    cursor: pointer;
    transition: color 0.3s;
}

.order-dialog .close-details:hover {
    color: #333;
}

/* Modal body */
.order-dialog .modal-body {
    margin-bottom: 20px;
}

.order-dialog .order-info p,
.order-dialog .ordered-items p {
    margin-bottom: 10px;
}

.order-dialog .ordered-items ul {
    list-style-type: none;
    padding: 0;
}

.order-dialog .item-details {
    display: flex;
    align-items: center;
}

.order-dialog .item-details img {
    width: 60px;
    height: auto;
    margin-right: 15px;
    border-radius: 4px;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
}

.order-dialog .item-info {
    flex-grow: 1;
}

/* Modal footer */
.order-dialog .modal-footer {
    border-top: 1px solid #ccc;
    padding-top: 20px;
    text-align: right;
}

.order-dialog .modal-footer button {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    background-color: #007bff;
    color: #fff;
    cursor: pointer;
    transition: background-color 0.3s;
}

.order-dialog .modal-footer button:hover {
    background-color: #0056b3;
}

</style>
</head>
<% if (toast !==undefined && toast !==null) { %>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">
	<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>

	<script>
		toastr.success('<%= toast %>');
	</script>
	<% } %>

		<% if (loginRequired) { %>
			<div id="loginModal" class="hello">
				<div class="hello-content">
					<p class="ppp">
						<%= loginMessage %>
					</p>
					<a class="aaa" href="/login">Login</a>
					<a class="aaa" href="/register">Sign Up</a>
					<a class="bbb" href="javascript:void(0);" onclick="goBack()">Go Back</a>
				</div>
			</div>
			<% } %>


				<body class="animsition">
					<!-- Header -->
					<header class="header-v3">
						<!-- Header desktop -->
						<div class="container-menu-desktop trans-03">
							<div class="wrap-menu-desktop">
								<nav class="limiter-menu-desktop p-l-45">

									<!-- Logo desktop -->
									<a href="/home" class="logo">
										<span id="logo">TRENDS</span>
									</a>

									<!-- Menu desktop -->
									<div class="menu-desktop">
										<ul class="main-menu">
											<li>
												<a href="/home">Home</a>
											</li>

											<li class="label1" data-label1="hot">
												<a href="/products">Shop</a>
											</li>

											<li>
												<a href="/cart">Cart</a>
											</li>

											<li>
												<a href="/about">About</a>
											</li>

											<li>
												<a href="/contact">Contact</a>
											</li>


										</ul>
									</div>

									<!-- Icon header -->
									<div class="wrap-icon-header flex-w flex-r-m h-full">
										<div class="wrap-icon-header flex-w flex-r-m">
											<!-- Login icon -->
											<% if (valid===undefined) { %>
												<a href="/login"
													class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-login"
													data-toggle="tooltip" title="Login">
													<i class="zmdi zmdi-alert-circle"></i>
												</a>
												<% } %>




													<a href="/cart"
														class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti "
														data-notify="<%= (cartItems !== null && typeof cartItems !== 'undefined') ? cartItems : 0 %>">
														<i class="zmdi zmdi-shopping-cart"></i>
													</a>

													<% if (valid) { %>
														<a href="whishlist"
															class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
															data-notify="<%= whishItems %>">
															<i class="zmdi zmdi-favorite-outline"></i>
														</a>&nbsp;&nbsp;&nbsp;
														<% }else{ %>
															<a href="/login"
																class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
																data-notify="0">
																<i class="zmdi zmdi-favorite-outline"></i>
															</a>&nbsp;&nbsp;&nbsp;
															<% } %>


																<% if (valid) { %>
																	<a href="/account" id="msgnoti"
																		class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
																		data-notify="<%= messages %>">
																		<i class="zmdi zmdi-account"></i>
																	</a>
																	<% } %>


										</div>
									</div>
									<% if (valid) { %>
										<div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-logout"
											data-toggle="modal" data-target="#logoutModal">
											<i class="zmdi zmdi-power-off"></i>
										</div>
										<% } %>
							</div>


							<!-- Logout Modal -->
							<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog"
								aria-labelledby="logoutModalLabel" aria-hidden="true">
								<div class="modal-dialog" role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title" id="logoutModalLabel">Logout Confirmation</h5>
											<button type="button" class="close" data-dismiss="modal" aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
										</div>
										<div class="modal-body">
											Are you sure you want to logout?
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-dismiss="modal">Cancel</button>
											<a href="/logout" class="btn btn-primary">Logout</a>
										</div>
									</div>
								</div>
							</div>

						</div>
						</nav>
						</div>
						</div>

						<!-- Header Mobile -->
						<div class="wrap-header-mobile">
							<!-- Logo moblie -->
							<div class="logo-mobile">
								<span id="logo1">TRENDS</span>
							</div>
							<% if (valid==undefined) { %>
								<a href="/login"
									class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-login"
									data-toggle="tooltip" title="Login">
									<i class="zmdi zmdi-alert-circle"></i>
								</a>&nbsp;&nbsp;
								<% } %>

									<div class="wrap-icon-header flex-w flex-r-m m-r-15">


										<a href="/cart"
											class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti "
											data-notify="<%= (cartItems !== null && typeof cartItems !== 'undefined') ? cartItems : 0 %>">
											<i class="zmdi zmdi-shopping-cart"></i>
										</a>

										<% if (valid) { %>
											<a href="whishlist"
												class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
												data-notify="<%= whishItems %>">
												<i class="zmdi zmdi-favorite-outline"></i>
											</a>&nbsp;&nbsp;&nbsp;
											<% }else{ %>
												<a href="/login"
													class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
													data-notify="0">
													<i class="zmdi zmdi-favorite-outline"></i>
												</a>&nbsp;&nbsp;&nbsp;
												<% } %>

													<% if (valid) { %>
														<a href="/account" id="msgnoti"
															class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
															data-notify="<%= messages %>">
															<i class="zmdi zmdi-account"></i>
														</a>
														<% } %>
									</div>

									<!-- Button show menu -->
									<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
										<span class="hamburger-box">
											<span class="hamburger-inner"></span>
										</span>
									</div>
						</div>


						<!-- Menu Mobile -->
						<div class="menu-mobile">
							<ul class="main-menu-m">
								<li>
									<a href="/home">Home</a>
									<span class="arrow-main-menu-m">
										<i class="fa fa-angle-right" aria-hidden="true"></i>
									</span>
								</li>

								<li>
									<a href="/products" class="label1 rs1" data-label1="hot">Shop</a>
								</li>

								<li>
									<a href="/cart">Cart</a>
								</li>


								<li>
									<a href="/about">About</a>
								</li>

								<li>
									<a href="/contact">Contact</a>
								</li>
								<li>
									<a href="/logout">Logout</a>
								</li>
							</ul>
						</div>

						<!-- Modal Search -->

					</header>

					<!-- Title page -->
					<section class="bg-img1 txt-center p-lr-15 p-tb-92"
						style="background-image: url('https://www.tatvasoft.com/outsourcing/wp-content/uploads/2022/07/What-is-eCommerce-How-does-eCommerce-work.jpg');">
						<h2 class="ltext-105 cl0 txt-center">
							Profile
						</h2>
					</section>

					<!-- User Account Details Section -->
					<section class="bg0 p-t-23 p-b-130">
						<div class="container">
							<div class="navigation-buttons">
								<button class="nav-button" id="personal-details-nav" style="color: black;"
									onclick="showPersonalInfo()">Personal Details</button>
								<button class="nav-button" id="address-nav" onclick="showAddresses()">Addresses</button>
								<button class="nav-button" id="orders-nav" onclick="showOrders()">Orders</button>
								<button class="nav-button" id="wallet-nav" onclick="showWallet()">Wallet</button>
								<button class="nav-button" id="coupon-nav" onclick="showCoupon()">Coupons</button>
								<button class="nav-button icon-msg-noti" data-notify="<%= messages %>" id="inbox-nav"
									onclick="showInbox()">Inbox</button>

								<% if (invoice) { %>
									<form action="/create-invoice" method="post" id="invoiceForm">
										<button class="nav-button" id="invoice-nav" style="background-color: #ffd50078;"
											type="button" onclick="downloadInvoice()">Download Invoice</button>
									</form>
								<% } %>

							</div>
							<div class="p-b-10">
								<h3 class="ltext-103 cl5" id="heading">
									Personal DETAILS
								</h3>
							</div>


							<div class="row">
								<div class="col-md-6">

									<div class="coupons-section" id="messagesection" style="display: none;">
										<div class="coupons-container">
											<h4>Unread Messages:</h4>
											<ul>
												<% if (message.length>0) { %>
													<% message.forEach(msg=> { %>
														<li class="coupon">
															<div class="coupon-details">you:
																<p class="coupon-description">
																	<%= msg.message %> <span
																			class="code"><code><% formatTime(msg.sendTime) %></code></span>
																</p><br>
																Customer Care:
																<h6 class="coupon-title">
																	<%= msg.replay %>
																</h6>
																<code><% formatTime(msg.replayTime) %></code>
																</p>
															</div>
															<button class="btn btn-outline-info read-btn"
																data-id="<%= msg.id %>">
																mark as read
																<span class="whatsapp-tick">&#10003;</span>
															</button>

														</li>
														<% }) %>
															<% }else{ %>
																<p style="color: #ec5a5a78;">no messages</p>
																<% } %>
											</ul>
										</div>
									</div>



									<% function formatTime(time) { %>
										<%= new Date(time).toLocaleTimeString([], { hour: '2-digit' , minute: '2-digit' }) %>
									<% } %>
												<div class="coupons-section" id="couponsection" style="display: none;">
													<div class="coupons-container">
														<h6>Available Coupons:</h6>
														<ul>
															<% coupons.forEach(coupon=> { %>
																<% if (coupon.expDate>=Date.now()) { %>
																	<li class="coupon">
																		<div class="coupon-details">
																			<h3 class="coupon-title">
																				<%= coupon.discAmt %>% Off on Clothes
																			</h3>
																			<p class="coupon-description">Use code:
																			  <span class="code"> <%= coupon.code %> </span>
																			</p>
																			<p class="coupon-description">Maximum Spend:
																			  <span class="code"> <%= coupon.maxAmount %> </span>
																			</p>
																			<p>Expires on: <%= coupon.expDate.toDateString()
																					%>
																			</p>
																		</div>
																		<button class="coupon-btn">Copy Code</button>
																	</li>
																<% } %>
															<% }) %>
														</ul>
													</div>
												</div>






												<div class="container_wallet" id="walletSection" style="display: none;">
													<div class="wallet-container">
														<div class="balance">
															<% if (wallet!==null) { %>
																<h2>Your Current Balance: ₹<%= wallet.balance.toFixed(2) || '0 Balance' %>
																</h2>
																<% } else{ %>
																	<h5>You Wallet Is Not Activated Yet</h5>
																	<% } %>

														</div>
														<% if (wallet!==null) { %>
															<div class="transactions">
																<h2>Recent Transactions:</h2>
																<ul>
																	<% if (wallet.transactions.length>0) { %>
																		<% wallet.transactions.forEach(transaction=> {
																			%>
																			<li
																				class="transaction-<%= transaction.type.toLowerCase() %>">
																				<div>
																					<p class="transaction-type">
																						<%= transaction.type==='credit'
																							?'Creditted':'Debitted' %>
																					</p>
																					<p>Amount: <span
																							class="transaction-amount-<%= transaction.type %>">
																							₹<%= transaction.amount.toFixed(2) %>
																						</span></p>
																				</div>
																				<p class="transaction-date">Date: <%=
																						transaction.date.toDateString()
																						%>
																				</p>
																			</li>
																			<% }) %>
																				<% }else{ %>
																					<h6>No Transactions Done Yet</h6>
																					<% } %>
																</ul>
															</div>
															<% } %>

													</div>

												</div>




												<!-- User Account Details -->

												<div class="block2-txt  flex-w flex-t p-t-14" id="personalInfo">
													<div class="block2-txt-child1 flex-col-l">


														<div class="block2-txt-child1 flex-col-l">
															<!-- Display User Information -->
															<form class="personal-info-form" id="userDetailsForm">
																<!-- Name -->
																<% if (msg !==null && typeof(msg) !=='undefined' ) { %>
																	<p class="error" id="emailError"
																		style="color: rgb(240, 22, 22); font-size: larger;">
																		<%= msg %>
																	</p>
																	<% } %>
																		<div class="form-group">
																			<div class="input-group">
																				<div>
																					<input type="text" id="name"
																						name="name"
																						class="bigger-text input-field"
																						value="<%= user.name %>"
																						readonly>
																					<small class="error-message"
																						id="nameError"></small>
																				</div>
																				<button class="edittt" type="button"
																					onclick="toggleEdit('name')">Edit</button>
																			</div>
																		</div>

																		<!-- Username -->
																		<div class="form-group">
																			<div class="input-group">
																				<div>
																					<input type="text" id="username"
																						name="username"
																						class="bigger-text input-field"
																						value="<%= user.username %>"
																						readonly>
																					<small class="error-message"
																						id="usernameError"></small>
																				</div>
																				<button class="edittt" type="button"
																					onclick="toggleEdit('username')">Edit</button>
																			</div>
																		</div>

																		<!-- Email -->
																		<div class="form-group">
																			<div class="input-group">
																				<div>
																					<input type="email" id="email"
																						name="email"
																						class="bigger-text input-field"
																						value="<%= user.email %>"
																						readonly>
																					<small class="error-message"
																						id="emailError"></small>
																				</div>
																			</div>
																		</div>

																		<!-- Gender -->
																		<div class="form-group">
																			<div class="input-group">
																				<div>
																					<label for="gender"
																						class="sr-only">Gender:</label>
																					<select id="gender" name="gender"
																						class="bigger-text input-field"
																						<% if (!editing) { %> disabled
																						<% } %>>
																							<option value="male" <% if
																								(user.gender==='male' )
																								{ %>
																								selected <% } %>>Male
																							</option>
																							<option value="female" <% if
																								(user.gender==='female'
																								) { %>
																								selected <% } %>>Female
																							</option>
																					</select>
																					<small class="error-message"
																						id="genderError"></small>
																				</div>
																				<button class="edittt" type="button"
																					onclick="toggleEdit('gender')">Edit</button>
																			</div>
																		</div>

																		<!-- Phone -->
																		<div class="form-group">
																			<div class="input-group">
																				<div>
																					<label for="phone"
																						class="sr-only">Phone:</label>
																					<input type="tel" minlength="10"
																						id="phone" name="phone"
																						class="bigger-text input-field"
																						value="<%= user.phone || 'N/A' %>"
																						readonly>
																					<small class="error-message"
																						id="phoneError"></small>
																				</div>
																				<button class="edittt" type="button"
																					onclick="toggleEdit('phone')">Edit</button>
																			</div>
																		</div>

																		<!-- Your existing HTML code -->
																		<div class="form-group">
																			<div class="input-group">
																				To Change Your Password
																				<button class="ssbutton"
																					style="color: #0056b3;"
																					type="button" id="open">Click me
																				</button>
																			</div>
																		</div>

																		<br><br>

																		<div id="submitContainer"
																			style="display: none;">
																			<button type="button" class="submit-btn"
																				onclick="update()">Submit</button>
																		</div>
															</form>

															<dialog>
																<form id="change-password">
																	<span>
																		<label for="oldpass">Old Password:</label>
																		<input type="password" id="oldpass"
																			name="oldpass" required>
																		<% if (err !==null && typeof (err)
																			!=='undefined' ) { %>
																			<p class="error" id="passError"
																				style="color: rgb(240, 22, 22); font-size: larger;">
																				<%= err %>
																			</p>
																			<% } %>
																				<br><br>
																	</span>
																	<label for="newpass">New Password:</label>
																	<input minlength="4" type="password" id="newpass"
																		name="password" required>
																	<br><br>
																	<label for="confirmpass">Confirm Password:</label>
																	<input type="password" id="confirmpass"
																		name="confirmpass" required>
																	<p class="error" id="confirmPassError"
																		style="color: rgb(240, 22, 22); font-size: larger;">
																	</p>
																	<br><br>
																	<button class="ssbutton" id="submitt"
																		type="button">Submit</button>
																	<div>
																		Forgot Your Password
																		<a onclick="resetmail('<%= user.email %>')"
																			style="color: #1e88e5;">Click Here</a>
																	</div>
																</form>
																<br>

																<div id="sssss">
																	<button id="close">Close</button>
																</div>

															</dialog>
														</div>
													</div>
												</div>
								</div>






								<div class="flipkart-address-section col-md-6" id="addresssssss">
									<!-- Addresses -->
									<div class="flipkart-address-block flipkart-block2-txt flex-w flex-t p-t-14 ">
										<div class="flipkart-address-block-child1 flex-col-l">
											<button
												class="flipkart-add-address bg1 bor1 flipkart-btn-add-address stext-101 cl0 size-103  p-lr-15"
												type="button" data-toggle="modal" data-target="#addAddressModal">
												Add New Address
											</button>
											<br><br>
											<!-- Addresses List -->
											<% if (user.address && user.address.length> 0) { %>
												<ul class="flipkart-address-list flipkart-list">
													<% user.address.forEach(function (address,i) { %>
														<li
															class="flipkart-address-item flipkart-item address<%= address._id %>">
															<div class="flipkart-address-box flipkart-box">
																<div class="flipkart-address-details flipkart-details">
																	<p class="flipkart-stext-107 cl7 "
																		style="font-size: 18px; margin-bottom: 8px;">
																		<%= address.streetAdress %>, <%= address.city %>
																				- <%= address.state %> road,<br>
																					<%= address.city %> - <%=
																							address.pincode %>
																	</p>
																	<p class="flipkart-stext-107 cl7 "
																		style="font-size: 18px; margin-bottom: 8px;">
																		Mobile: <%= address.mobile %>, Email: <%=
																				address.email %>
																	</p>
																</div>
																<div class="flipkart-address-actions flipkart-actions">
																	<div class="flipkart-dropdown dropdown"
																		style="position: absolute; top: 5px; right: 5px; ">
																		<button class="dropdown-btn"
																			style="font-size: xx-large;">&#8285;</button>
																		<div
																			class="flipkart-dropdown-content dropdown-content">
																			<button class="edit-btn" data-toggle="modal"
																				data-target="#editAddressModal<%= address._id %>">Edit</button>
																			<a href="#"
																				onclick="deleteAddress('<%= address._id %>')"
																				style="display: block; padding: 10px;">Delete</a>

																		</div>
																	</div>
																</div>
															</div>
														</li>

														<!-- Edit Address Modal -->
														<div class="modal fade" id="editAddressModal<%= address._id %>"
															tabindex="-1" role="dialog"
															aria-labelledby="editAddressModalLabel" aria-hidden="true">
															<div class="modal-dialog" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																		<h5 class="modal-title"
																			id="editAddressModalLabel">Edit
																			Address
																		</h5>
																	</div>
																	<div class="modal-body">
																		<form id="editAddressForm<%= address._id %>">
																			<!-- First Name and Last Name -->
																			<div class="row">
																				<div class="col-md-6">
																					<div class="form-group">
																						<label
																							for="editFirstName<%= address._id %>">First
																							Name:</label>
																						<input type="text"
																							class="form-control"
																							value="<%= address.Fname %>"
																							id="editFirstName<%= address._id %>"
																							name="Fname" required>
																					</div>
																				</div>
																				<div class="col-md-6">
																					<div class="form-group">
																						<label
																							for="editLastName<%= address._id %>">Last
																							Name:</label>
																						<input type="text"
																							class="form-control"
																							value="<%= address.Lname %>"
																							id="editLastName<%= address._id %>"
																							name="Lname" required>
																					</div>
																				</div>
																			</div>

																			<!-- Company Name -->
																			<div class="form-group">
																				<label
																					for="editCompanyName<%= address._id %>">Company
																					Name:</label>
																				<input type="text" class="form-control"
																					value="<%= address.companyName %>"
																					id="editCompanyName<%= address._id %>"
																					name="companyName">
																			</div>

																			<!-- Country -->
																			<div class="form-group">
																				<label
																					for="editCountry<%= address._id %>">Country:</label>
																				<input type="text" class="form-control"
																					value="<%= address.country %>"
																					id="editCountry<%= address._id %>"
																					name="country" required>
																			</div>

																			<!-- Street Address -->
																			<div class="form-group">
																				<label
																					for="editStreetAddress<%= address._id %>">Street
																					Address:</label>
																				<input type="text" class="form-control"
																					value="<%= address.streetAdress %>"
																					id="editStreetAddress<%= address._id %>"
																					name="streetAdress" required>
																			</div>

																			<!-- City, State, and Pincode -->
																			<div class="row">
																				<div class="col-md-4">
																					<div class="form-group">
																						<label
																							for="editCity<%= address._id %>">City:</label>
																						<input type="text"
																							class="form-control"
																							value="<%= address.city %>"
																							id="editCity<%= address._id %>"
																							name="city" required>
																					</div>
																				</div>
																				<div class="col-md-4">
																					<div class="form-group">
																						<label
																							for="editState<%= address._id %>">State:</label>
																						<input type="text"
																							class="form-control"
																							value="<%= address.state %>"
																							id="editState<%= address._id %>"
																							name="state" required>
																					</div>
																				</div>
																				<div class="col-md-4">
																					<div class="form-group">
																						<label
																							for="editPincode<%= address._id %>">Pincode:</label>
																						<input type="number"
																							class="form-control"
																							value="<%= address.pincode %>"
																							id="editPincode<%= address._id %>"
																							name="pincode" required>
																					</div>
																				</div>
																			</div>

																			<!-- Mobile and Email -->
																			<div class="row">
																				<div class="col-md-6">
																					<div class="form-group">
																						<label
																							for="editMobile<%= address._id %>">Mobile:</label>
																						<input type="number"
																							class="form-control"
																							value="<%= address.mobile %>"
																							id="editMobile<%= address._id %>"
																							name="mobile" required>
																					</div>
																				</div>
																				<div class="col-md-6">
																					<div class="form-group">
																						<label
																							for="editEmail<%= address._id %>">Email:</label>
																						<input type="email"
																							class="form-control"
																							value="<%= address.email %>"
																							id="editEmail<%= address._id %>"
																							name="email" required>
																					</div>
																				</div>
																			</div>

																			<div class="edit-error-container alert alert-danger mt-3"
																				style="display: none;"></div>

																			<div class="modal-footer">
																				<button type="button"
																					class="btn btn-secondary"
																					data-dismiss="modal">Close</button>
																				<button type="button"
																					class="btn btn-primary"
																					onclick="submitEditAddress(event,'<%= address._id %>')">Save
																					Changes</button>
																			</div>
																		</form>
																	</div>
																</div>
															</div>
														</div>
														<% if (i==address.length ) { %>
															<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
															<% } %>


																<% }); %>
												</ul>
												<% } else { %>
													<div class="flipkart-flex-center flex-center">
														<p class="flipkart-stext-107 cl7 hov-cl1 trans-04"
															style="font-size: 18px; color: #333;">
															No addresses found.
														</p>
													</div>
													<% } %>


										</div>
									</div>
								</div>





							</div>

						</div>
						</div>

						<div class="row mt-4" id="orders">
							<div class="col-md-12">
								<div class="order-sort-container">
									<label for="sort-select">Filter:</label>
									<select id="sort-select" name="sort-select" onchange="orderFilter(event)">
										<option value="all" <%=filter==='all' ?'selected':'' %>>Proccessing</option>
										<option value="5" <%=filter==='5' ?'selected':'' %>>Cancelled</option>
										<option value="4" <%=filter==='4' ?'selected':'' %>>Delivered</option>
									</select>
								</div>

								<div class="flipkart-address-block-child3 flex-col-l">
									<% if (orders && orders.length> 0) { %>
									    <% orders.forEach((order,i)=> { %>
									        <div class="order-details border rounded p-4 mb-4">
									            <div class="d-flex justify-content-between align-items-center mb-3">
									                <h4 class="mb-0">Order ID: SKe5<%=i%>
									                </h4>
									                <span class="badge rounded-pill 
									                    <% if (order.isPending) { %>bg-danger
									                    <% } else if (order.orderStatus === '1') { %> bg-warning
									                    <% } else if (order.orderStatus === '2') { %> bg-info
									                    <% } else if (order.orderStatus === '3') { %> bg-primary
									                    <% } else if (order.orderStatus === '4') { %> bg-success
									                    <% } else if (order.orderStatus === '5') { %> bg-danger
									                    <% } %> text-white">
									                    <% if (order.isPending ) { %> Payment Pendng
									                        <% } else if (order.orderStatus==='1' ) { %> Processing
									                            <% } else if (order.orderStatus==='2' ) { %> Quality Check
									                                <% } else if (order.orderStatus==='3' ) { %> Shipped
									                                    <% } else if (order.orderStatus==='4' ) { %> Delivered
									                                        <% } else if (order.orderStatus==='5' ) { %> Canceled
									                                            <% } %>
									                </span>
									            </div>
									            <p>Order Amount: <%= order.orderAmount %>
									                <p>Payment Status: <%= order.paymentStatus %>
									                    </p>
									                    <% if (order.orderStatus !=='4' ) { %>
									                        <p>Expected Delivery on: <%=
									                                order.deliveryDate.toDateString() %>
									                        </p>
									                        <% } else { %>
									                            <p> Delivered on: <%= order.deliveryDate.toDateString() %> </p>
									                            <% } %>
									                                <p> Ordered Items:</p>
									                                <ul class="list-unstyled">
									                                    <% order.OrderedItems.forEach(item=> { %>
									                                        <li>
									                                            <strong>
									                                                <%= item.name %>
									                                            </strong>
									                                            - Quantity: <%= item.quantity %>
									                                                - Price: ₹<%= item.price * item.discount/100 %> %>
									                                        </li>
									                                        <% }); %>
									                                </ul>
									                                <% if (order.orderStatus=='4' ||order.orderStatus=='5' ) { %>
																	
									                                    <% } else { %>
									                                        <button class="btn btn-danger"
									                                            onclick="showCancelModal('<%= order._id %>')">Cancel</button>
									                                        <% } %>
																		
									                                        <button id="order-details-<%= i %>" data-details="<%= JSON.stringify(order) %>" class="btn nav-button" style="height: 40px;width: 100px;">Details</button>
									                                        <dialog id="orderDialog-<%= i %>" class="order-dialog">
									                                            <div class="modal-wrapper">
									                                                <div class="modal-header">
									                                                    <h2>Order Details</h2>
									                                                    <button class="close-details" >&times;</button>
									                                                </div>
									                                                <div class="modal-body">
									                                                    <div class="order-info">
									                                                        <p><strong>Order ID:</strong> <%= order._id %></p><hr>
																							<p><strong>Order Status:</strong> 
																								
																							    <% if (order.isPending) { %>
																							        <span class="badge bg-danger text-white">Payment Pending</span>
																							    <% } else if (order.orderStatus === '1') { %>
																							        <span class="badge bg-warning text-white">Processing</span>
																							    <% } else if (order.orderStatus === '2') { %>
																							        <span class="badge bg-info text-white">Quality Check</span>
																							    <% } else if (order.orderStatus === '3') { %>
																							        <span class="badge bg-primary text-white">Shipped</span>
																							    <% } else if (order.orderStatus === '4') { %>
																							        <span class="badge bg-success text-white">Delivered</span>
																							    <% } else if (order.orderStatus === '5') { %>
																							        <span class="badge bg-danger text-white">Canceled</span>
																							    <% } %>
																							</p><hr>
																							<p><strong>Payment :</strong>
																								<% if (order.paymentType =='offline') { %>
    																							    Cash on Delivery <br>
    																							    Amount: <%= order.orderAmount %> <br>
    																							    Date: <%= order.orderDate.toDateString() %> <br>
    																							<% } else if (order.paymentType=='online_pending') { %>
    																							    Amount: <%= order.orderAmount %> <br>
    																							    Date: <%= order.orderDate.toDateString() %> <br>
    																							    Date: <%= order.orderDate.toDateString() %> <br>
    																							    Payment Pending
    																							<% } else if (order.paymentType=='online') { %>
    																							    Date: <%= order.orderDate.toDateString() %> <br>
    																							    Amount: <%= order.orderAmount %> <br>
    																							    Transaction ID: <small> <%= order.online_payment.transactionid %></small>
    																							<% } else if(order.paymentType=="wallet") { %>
    																							    Date: <%= order.orderDate.toDateString() %> <br>
    																							    Amount: <%= order.orderAmount %> <br>
    																							    Transaction ID: <small><%= order.walletPayment.transactionid %></small>
    																							<% } else { %>
    																							    No payment information available.
    																							<% } %>
																							</p><hr>
																							<% if (order.coupon) { %>
																							    <% 
																							        const discountAmount = order.orderAmount * (order.coupon / 100);
																							        const discountedPrice = order.orderAmount - discountAmount;
																							    %>
																							    <p><strong>Coupon discount :</strong> ₹<%= discountedPrice %></p>
																							<% } %>
																							<p><strong>Order Amount:</strong> ₹<%= order.orderAmount.toFixed(2) %></p>
																							<hr>

									                                                        <p><strong>Delivery Address:</strong> <%= order.deliveryAddress.streetAddress %>, <%= order.deliveryAddress.city %>, <%= order.deliveryAddress.state %>, <%= order.deliveryAddress.country %>, <%= order.deliveryAddress.pincode %></p><hr>
									                                                    </div>
									                                                    <div class="ordered-items">
									                                                        <p><strong>Ordered Items:</strong></p>
									                                                        <ul>
									                                                            <% order.OrderedItems.forEach(item => { %>
									                                                                <li>
									                                                                    <div class="item-details">
																											<a href="/product?id=<%= item.productid %>">
																												<img src="/resized_images/<%= item.img %>" alt="<%= item.name %>">
																											</a>
									                                                                        <div class="item-info">
									                                                                            <p><strong><%= item.name %></strong></p>
									                                                                            <p>Quantity: <%= item.quantity %></p>
																												<p>Price: ₹<%= item.price - (item.price * item.discount / 100) %></p>
									                                                                        </div>
									                                                                    </div>
									                                                                </li>
									                                                                <% }); %>
									                                                        </ul>
									                                                    </div>
									                                                </div>
									                                                <div class="modal-footer">
									                                                    <button class="close-details" id="close-details">Close</button>
									                                                </div>
									                                            </div>
									                                        </dialog>
									        </div>
									        <% }); %>
									            <% } else { %>
									                <h5>No orders found.</h5>
									                <br><br><br><br><br>
									                <% } %>
                    

								</div>
							</div>
							
							<div class="flex-c-m flex-w w-full p-t-38">
								<% for (let i=1; i <=totalPages; i++) { %>
									<a onclick="accountPagination('<%= i %>','<%= filter%>')"
										class="flex-c-m how-pagination1 trans-04 m-all-7 <% if (currentPage === i) { %>active-pagination1<% } %>">
										<%= i %>
									</a>
									<% } %>
							</div>
						</div>

					</section>
					
					<script>
						$(document).ready(function () {
							const dialogs = document.querySelectorAll(".order-dialog");
						
							dialogs.forEach((dialog, index) => {
								const showOrderDetails = document.querySelector(`#order-details-${index}`);
								const closeBtn = dialog.querySelector("#close-details");
								const content = dialog.querySelector(".content");
								let order;
							
								showOrderDetails.addEventListener("click", (event) => {
									order = JSON.parse(event.target.dataset.details);
									dialog.classList.add('open');
									dialog.showModal();
									// content.innerHTML = `<strong>${order._id}</strong>`;
								});
							
								closeBtn.addEventListener("click", () => {
									dialog.classList.remove('open');
									dialog.close();
								});
							
								dialog.addEventListener('click', (event) => {
									if (event.target === dialog) {
										dialog.classList.remove('open');
										dialog.close();
									}
								});
							
								document.addEventListener('keydown', (event) => {
									if (event.key === 'Escape' && dialog.classList.contains('open')) {
										dialog.classList.remove('open');
										dialog.close();
									}
								});
							});
						});
					</script>

					<div class="modal fade" id="cancelModal" tabindex="-1" role="dialog"
						aria-labelledby="cancelModalLabel" aria-hidden="true">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="cancelModalLabel">Cancel Order</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<form id="cancelOrderForm">
										<input type="hidden" id="cancelOrderId">
										<div class="form-group">
											<label for="cancelReason">Reason for cancellation:</label>
											<small>At least 10 Charectres</small>
											<textarea class="form-control" minlength="10" id="cancelReason"
												name="cancelReason" rows="3" required></textarea>
										</div>
										<button type="button" onclick="submitCancelOrder()"
											class="btn btn-danger">Confirm Cancellation</button>
									</form>
								</div>
							</div>
						</div>
					</div>





					<!-- Add Address Modal -->
					<div class="modal fade" id="addAddressModal" tabindex="-1" role="dialog"
						aria-labelledby="addAddressModalLabel" aria-hidden="true">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="addAddressModalLabel">Add New Address</h5>
								</div>
								<div class="modal-body">
									<form id="newAddressForm">
										<!-- First Name and Last Name -->
										<div class="row">
											<div class="col-md-6">
												<div class="form-group">
													<label for="newFirstName">First Name:</label>
													<input type="text" class="form-control" id="newFirstName"
														name="Fname">
												</div>
											</div>
											<div class="col-md-6">
												<div class="form-group">
													<label for="newLastName">Last Name:</label>
													<input type="text" class="form-control" id="newLastName"
														name="Lname">
												</div>
											</div>
										</div>

										<!-- Company Name -->
										<div class="form-group">
											<label for="newCompanyName">Company Name:</label>
											<input type="text" class="form-control" id="newCompanyName"
												name="companyName">
										</div>

										<!-- Country -->
										<div class="form-group">
											<label for="newCountry">Country:</label>
											<input type="text" class="form-control" id="newCountry" name="country">
										</div>

										<!-- Street Address -->
										<div class="form-group">
											<label for="newStreetAddress">Street Address:</label>
											<input type="text" class="form-control" id="newStreetAddress"
												name="streetAdress" required>
										</div>

										<!-- City, State, and Pincode -->
										<div class="row">
											<div class="col-md-4">
												<div class="form-group">
													<label for="newCity">City:</label>
													<input type="text" class="form-control" id="newCity" name="city">
												</div>
											</div>
											<div class="col-md-4">
												<div class="form-group">
													<label for="newState">State:</label>
													<input type="text" class="form-control" id="newState" name="state">
												</div>
											</div>
											<div class="col-md-4">
												<div class="form-group">
													<label for="newPincode">Pincode:</label>
													<input type="number" class="form-control" id="newPincode"
														name="pincode">
												</div>
											</div>
										</div>

										<!-- Mobile and Email -->
										<div class="row">
											<div class="col-md-6">
												<div class="form-group">
													<label for="newMobile">Mobile:</label>
													<input type="number" class="form-control" id="newMobile"
														name="mobile">
												</div>
											</div>
											<div class="col-md-6">
												<div class="form-group">
													<label for="newEmail">Email:</label>
													<input type="email" class="form-control" id="newEmail" name="email">
												</div>
											</div>
										</div>

										<div class="error-container alert alert-danger mt-3" style="display: none;">
										</div>

										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-dismiss="modal">Close</button>
											<button type="button" class="btn btn-primary"
												onclick="submitNewAddress()">Save
												Address</button>
										</div>
									</form>

								</div>
							</div>
						</div>
					</div>




					<div class="modal fade" id="emailSendingModal" tabindex="-1" role="dialog"
						aria-labelledby="emailSendingModalLabel" aria-hidden="true">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="emailSendingModalLabel">Email Sending Status
									</h5>
									<button type="button" class="close" data-dismiss="modal" aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div class="modal-body">
									<p id="emailSendingMessage"></p>
								</div>
							</div>
						</div>
					</div>



					<!-- Footer -->
					<footer class="bg3 p-t-75 p-b-32">
						<div class="container">
							<div class="row">
								<div class="col-sm-6 col-lg-3 p-b-50">
									<h4 class="stext-301 cl0 p-b-30">
										Categories
									</h4>

									<ul>
										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Women
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Men
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Shoes
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Watches
											</a>
										</li>
									</ul>
								</div>

								<div class="col-sm-6 col-lg-3 p-b-50">
									<h4 class="stext-301 cl0 p-b-30">
										Help
									</h4>

									<ul>
										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Track Order
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Returns
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												Shipping
											</a>
										</li>

										<li class="p-b-10">
											<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
												FAQs
											</a>
										</li>
									</ul>
								</div>

								<div class="col-sm-6 col-lg-3 p-b-50">
									<h4 class="stext-301 cl0 p-b-30">
										GET IN TOUCH
									</h4>

									<p class="stext-107 cl7 size-201">
										Any questions? Let us know in store at 8th floor, 379 Hudson St, New York, NY
										10018 or
										call us
										on (+1) 96 716 6879
									</p>

									<div class="p-t-27">
										<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
											<i class="fa fa-facebook"></i>
										</a>

										<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
											<i class="fa fa-instagram"></i>
										</a>

										<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
											<i class="fa fa-pinterest-p"></i>
										</a>
									</div>
								</div>

								<div class="col-sm-6 col-lg-3 p-b-50">
									<h4 class="stext-301 cl0 p-b-30">
										Newsletter
									</h4>

									<form>
										<div class="wrap-input1 w-full p-b-4">
											<input class="input1 bg-none plh1 stext-107 cl7" type="text" name="email"
												placeholder="email@example.com">
											<div class="focus-input1 trans-04"></div>
										</div>

										<div class="p-t-18">
											<button
												class="flex-c-m stext-101 cl0 size-103 bg1 bor1 hov-btn2 p-lr-15 trans-04">
												Subscribe
											</button>
										</div>
									</form>
								</div>
							</div>

							<div class="p-t-40">
								<div class="flex-c-m flex-w p-b-18">
									<a href="#" class="m-all-1">
										<img src="images/icons/icon-pay-01.png" alt="ICON-PAY">
									</a>

									<a href="#" class="m-all-1">
										<img src="images/icons/icon-pay-02.png" alt="ICON-PAY">
									</a>

									<a href="#" class="m-all-1">
										<img src="images/icons/icon-pay-03.png" alt="ICON-PAY">
									</a>

									<a href="#" class="m-all-1">
										<img src="images/icons/icon-pay-04.png" alt="ICON-PAY">
									</a>

									<a href="#" class="m-all-1">
										<img src="images/icons/icon-pay-05.png" alt="ICON-PAY">
									</a>
								</div>

								<p class="stext-107 cl6 txt-center">
									<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
									Copyright &copy;
									<script>document.write(new Date().getFullYear());</script> All rights reserved |
									Made with
									<i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com"
										target="_blank">Colorlib</a> &amp; distributed by <a
										href="https://themewagon.com" target="_blank">ThemeWagon</a>
									<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->

								</p>
							</div>
						</div>
					</footer>


					<!-- Back to top -->
					<div class="btn-back-to-top" id="myBtn">
						<span class="symbol-btn-back-to-top">
							<i class="zmdi zmdi-chevron-up"></i>
						</span>
					</div>


					<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
					<script src="vendor/animsition/js/animsition.min.js"></script>
					<script src="vendor/bootstrap/js/popper.js"></script>
					<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
					<script src="vendor/select2/select2.min.js"></script>
					<script>
						$(".js-select2").each(function () {
							$(this).select2({
								minimumResultsForSearch: 20,
								dropdownParent: $(this).next('.dropDownSelect2')
							});
						})


					</script>
					<script src="vendor/daterangepicker/moment.min.js"></script>
					<script src="vendor/daterangepicker/daterangepicker.js"></script>
					<script src="vendor/slick/slick.min.js"></script>
					<script src="js/slick-custom.js"></script>
					<script src="vendor/parallax100/parallax100.js"></script>
					<script>
						$('.parallax100').parallax100();
					</script>
					<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
					<script>
						$('.gallery-lb').each(function () { // the containers for all your galleries
							$(this).magnificPopup({
								delegate: 'a', // the selector for gallery item
								type: 'image',
								gallery: {
									enabled: true
								},
								mainClass: 'mfp-fade'
							});
						});
					</script>
					<script src="vendor/isotope/isotope.pkgd.min.js"></script>
					<script src="vendor/sweetalert/sweetalert.min.js"></script>
					<script>
						$('.js-addwish-b2').on('click', function (e) {
							e.preventDefault();
						});

						$('.js-addwish-b2').each(function () {
							var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
							$(this).on('click', function () {
								swal(nameProduct, "is added to wishlist !", "success");

								$(this).addClass('js-addedwish-b2');
								$(this).off('click');
							});
						});

						$('.js-addwish-detail').each(function () {
							var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();

							$(this).on('click', function () {
								swal(nameProduct, "is added to wishlist !", "success");

								$(this).addClass('js-addedwish-detail');
								$(this).off('click');
							});
						});

						/*---------------------------------------------*/

						$('.js-addcart-detail').each(function () {
							var nameProduct = $(this).parent().parent().parent().parent().find('.js-name-detail').html();
							$(this).on('click', function () {
								swal(nameProduct, "is added to cart !", "success");
							});
						});
					</script>
					<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
					<script>
						$('.js-pscroll').each(function () {
							$(this).css('position', 'relative');
							$(this).css('overflow', 'hidden');
							var ps = new PerfectScrollbar(this, {
								wheelSpeed: 1,
								scrollingThreshold: 1000,
								wheelPropagation: false,
							});

							$(window).on('resize', function () {
								ps.update();
							})
						});
					</script>
					<script src="js/main.js"></script>

				</body>

</html>